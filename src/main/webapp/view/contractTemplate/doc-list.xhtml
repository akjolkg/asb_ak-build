<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/layouts/private.xhtml">
	<ui:define name="content">
		<h2>#{msgs.documentTemplateList}</h2>
		<h:form>
			<p:commandButton value="Ключевые слова для шаблонов"
				styleClass="button blue f-left"
				onclick="PF('instructionsDialog').show();" />
		</h:form>

		<p:dialog header="Ключевые слова для шаблонов"
			widgetVar="instructionsDialog" modal="true" closable="true" height="500"
			resizable="true" >
			<h:outputText value="Инструкции по использованию этой страницы:" />
			<ul>
				<li><strong>2TextZayavleniya:</strong> Текст подтверждения
					заявления.</li>
				<li><strong>appartmentApEntrance:</strong> Номер входа в
					квартиру.</li>
				<li><strong>appartmentBlock:</strong> Номер блока квартиры.</li>
				<li><strong>appartmentEntrance:</strong> Номер подъезда
					квартиры.</li>
				<li><strong>appartmentFlat:</strong> Номер квартиры.</li>
				<li><strong>appartmentNumber:</strong> Название квартиры,
					включает данные инвентаризации, если применимо.</li>
				<li><strong>appartmentRoomQuantity:</strong> Количество комнат
					в квартире.</li>
				<li><strong>appartmentTotalArea:</strong> Общая площадь
					квартиры, включает данные инвентаризации, если применимо.</li>
				<li><strong>appartmentTypeR:</strong> Тип квартиры (например,
					квартиры, помещения и т.д.).</li>
				<li><strong>city:</strong> Город строительства, по умолчанию
					'г. Бишкек', если значение null.</li>
				<li><strong>cldate:</strong> Заполнитель для даты в семейном
					положении.</li>
				<li><strong>clientAddress:</strong> Паспортный адрес клиента.</li>
				<li><strong>clientBirthDate:</strong> Дата рождения клиента,
					отформатированная как строка.</li>
				<li><strong>clientDetails:</strong> Детали клиента, включая
					тестовые заполнители.</li>
				<li><strong>clientFactAddress:</strong> Фактический адрес
					клиента.</li>
				<li><strong>clientFullName:</strong> Полное имя клиента.</li>
				<li><strong>clientInn:</strong> ИНН (идентификационный номер
					налогоплательщика) клиента.</li>
				<li><strong>clientMarriageText1:</strong> Текст, указывающий
					семейное положение клиента.</li>
				<li><strong>clientMarriageText2:</strong> Дополнительный текст
					для семейного положения, если применимо.</li>
				<li><strong>clientPassport:</strong> Номер паспорта клиента.</li>
				<li><strong>clientPhone:</strong> Контактные данные клиента.</li>
				<li><strong>clientPin:</strong> ПИН (персональный
					идентификационный номер) клиента.</li>
				<li><strong>clientWhatsapp:</strong> Номер WhatsApp клиента.</li>
				<li><strong>clfio:</strong> Заполнитель для полного имени в
					семейном положении.</li>
				<li><strong>cllineLong:</strong> Длинная линия для подписи в
					семейном положении.</li>
				<li><strong>cllineshort:</strong> Короткая линия для подписи в
					семейном положении.</li>
				<li><strong>clsign:</strong> Заполнитель для подписи в семейном
					положении.</li>
				<li><strong>companyAccountNumber:</strong> Номер счета
					компании.</li>
				<li><strong>companyAddress:</strong> Адрес компании.</li>
				<li><strong>companyBank:</strong> Название банка компании.</li>
				<li><strong>companyBik:</strong> БИК банка компании.</li>
				<li><strong>companyInn:</strong> ИНН (идентификационный номер
					налогоплательщика) компании.</li>
				<li><strong>companyOkpo:</strong> Код ОКПО компании.</li>
				<li><strong>companyPostalAddress:</strong> Почтовый адрес
					компании.</li>
				<li><strong>companyRegistration:</strong> Юридическая
					информация компании.</li>
				<li><strong>companyResponsiblePersonIs:</strong> Ответственное
					лицо компании (полные данные).</li>
				<li><strong>companyRPShort:</strong> Краткое имя ответственного
					лица компании.</li>
				<li><strong>companySite:</strong> Веб-сайт компании.</li>
				<li><strong>companyTitle:</strong> Название компании.</li>
				<li><strong>competentnieOrgany:</strong> Текст для компетентных
					органов для контрактов государственной регистрации.</li>
				<li><strong>constructionAddress:</strong> Планируемый адрес
					строительства.</li>
				<li><strong>constructionDocs:</strong> Юридические документы
					строительства.</li>
				<li><strong>constructionEni:</strong> Идентификационный номер
					строительства.</li>
				<li><strong>constructionIdentificationNumber:</strong>
					Идентификационный номер строительства.</li>
				<li><strong>constructionName:</strong> Название строительства.</li>
				<li><strong>constructionSmr:</strong> Планируемая дата
					строительства, отформатированная как строка.</li>
				<li><strong>constructionSve:</strong> Фактическая дата
					строительства, отформатированная как строка.</li>
				<li><strong>contract711:</strong> Дополнительный текст для типа
					контракта.</li>
				<li><strong>contractDate:</strong> Дата контракта,
					отформатированная как строка.</li>
				<li><strong>contractDay:</strong> День даты контракта.</li>
				<li><strong>contractModificationNumber:</strong> Номер
					модификации контракта, увеличенный на 1.</li>
				<li><strong>contractMonth:</strong> Месяц даты контракта.</li>
				<li><strong>contractNumber:</strong> Номер контракта клиента.</li>
				<li><strong>contractPerSquareNum:</strong> Цена за квадратный
					метр в числовом формате.</li>
				<li><strong>contractPerSquareText:</strong> Форматированная
					цена за квадратный метр в текстовом виде.</li>
				<li><strong>contractQuantity:</strong> Количество контрактов в
					зависимости от типа.</li>
				<li><strong>contractSumFact:</strong> Общая сумма контракта в
					числовом формате после инвентеризации.</li>
				<li><strong>contractSumSignDoc:</strong> Общая сумма контракта в
					числовом формате после инвентеризации без учета скидок.</li>
				<li><strong>contractSumSomNum:</strong> Общая сумма контракта в
					числовом формате.</li>
				<li><strong>contractSumSomText:</strong> Форматированная общая
					сумма контракта в текстовом виде.</li>
				<li><strong>contractType:</strong> Тип контракта.</li>
				<li><strong>contractYear:</strong> Год даты контракта.</li>
				<li><strong>crmNumber:</strong> CRM номер клиента, по умолчанию
					пустая строка, если значение null.</li>
				<li><strong>curatorOp:</strong> Куратор клиента, по умолчанию '-'
					если значение null.</li>
				<li><strong>curatorOrk:</strong> Куратор ОРК, по умолчанию '-'
					если значение null.</li>
				<li><strong>dateContract:</strong> Дата контракта,
					отформатированная как строка.</li>
				<li><strong>extraLow:</strong> Текст, указывающий статус ниже
					сетки, по умолчанию 'Ниже сетки!!!', если true.</li>
				<li><strong>finDir:</strong> Финансовый директор компании, по
					умолчанию пустая строка, если значение null.</li>
				<li><strong>finDira:</strong> Финансовый директор компании, по
					умолчанию пустая строка, если значение null.</li>
				<li><strong>firstPaymentSumSomNum:</strong> Сумма первого
					платежа в числовом формате.</li>
				<li><strong>firstPaymentSumSomText:</strong> Форматированная
					сумма первого платежа в текстовом виде.</li>
				<li><strong>installmentDate:</strong> Дата рассрочки,
					отформатированная как строка.</li>
				<li><strong>installmentNote:</strong> Примечание о продлении
					рассрочки на основе разницы в днях.</li>
				<li><strong>longCompanyTitle:</strong> Полное название
					компании.</li>
				<li><strong>note:</strong> Дополнительные заметки о клиенте, по
					умолчанию пустая строка, если значение null.</li>
				<li><strong>otAddress:</strong> Адрес клиента для контрактов
					государственной регистрации.</li>
				<li><strong>otClientFrom:</strong> Текст, указывающий клиента
					как отправителя.</li>
				<li><strong>otPassport:</strong> Данные паспорта клиента для
					контрактов государственной регистрации.</li>
				<li><strong>procuration:</strong> Доверенность компании.</li>
				<li><strong>responsibleFrom:</strong> Детали ответственного
					лица, по умолчанию пустая строка, если не применимо.</li>
				<li><strong>shortCompanyTitle:</strong> Краткое название
					компании.</li>
				<li><strong>signPerson:</strong> Лицо, ответственное за
					подписание контракта.</li>
				<li><strong>textClientBirthdate:</strong> Форматированная дата
					рождения клиента для контрактов государственной регистрации.</li>
				<li><strong>textZayavleniya:</strong> Подробный текст заявления
					для контрактов государственной регистрации.</li>
				<li><strong>toForeman:</strong> Детали мастера, по умолчанию
					пустая строка, если значение null.</li>
				<li><strong>toLowyer:</strong> Юристу в дательном падеже, по умолчанию
					пустая строка, если значение null.</li>				
				<li><strong>today:</strong> Текущая дата, отформатированная как
					строка.</li>
				<li><strong>zayavlenie:</strong> Текст заявления для контрактов
					государственной регистрации.</li>
			</ul>
		</p:dialog>

		<br />
		<div class="clear"></div>
		<h:form rendered="#{roleController.isAllowed('ADMIN')}">
			<h:commandLink value="#{msgs.addDocumentTemplate}"
				action="#{documentTemplateCreator.add()}"
				styleClass="button green f-right" />
		</h:form>
		<br />
		<div class="clear"></div>
		<h:form id="filter-form">
			<p:growl escape="false" />
			<h:panelGrid columns="2" styleClass="f-left">
				<h:outputText value="#{msgs.documentType}"
					styleClass="form-table-label disp-blc" />
				<h:outputText value="#{msgs.searchString}"
					styleClass="form-table-label disp-blc" />

				<p:selectCheckboxMenu
					value="#{documentTemplateListController.filterDocumentTemplates}"
					multiple="true" id="type" style="width:250px;" styleClass="m-right"
					filter="true" filterMatchMode="contains" converter="enumConverter">
					<f:selectItems
						value="#{documentTemplateListController.allDocumentTemplateTypes}"
						var="entity" itemLabel="#{enums[entity]}" itemValue="#{entity}" />
				</p:selectCheckboxMenu>
				<h:inputText value="#{documentTemplateListController.searchString}"
					id="searchString" styleClass="m-right" />
			</h:panelGrid>
			<h:panelGrid columns="2" styleClass="f-left">
				<h:outputText value="" styleClass="label" />
				<h:outputText value="" styleClass="label" />

				<p:commandButton ajax="true" update="form" value="#{msgs.search}"
					actionListener="#{documentTemplateListController.filterData()}"
					styleClass="button green f-right m-left" />
				<p:commandButton ajax="true" update="form filter-form"
					value="#{msgs.clearFilter}"
					actionListener="#{documentTemplateListController.clearFilter()}"
					styleClass="button blue f-right" />
			</h:panelGrid>
		</h:form>


		<div class="clear"></div>
		<h:form id="form">
			<p:dataTable var="entity"
				value="#{documentTemplateListController.model}" paginator="true"
				rows="50" lazy="true" rowKey="#{entity.id}" rowIndexVar="index"
				tableStyleClass="display-table" id="table" selectionMode="single"
				emptyMessage="#{msgs.noRecordsFound}"
				rowsPerPageTemplate="10,20,30,40,50" paginatorPosition="bottom"
				pageLinks="10"
				currentPageReportTemplate="Всего : #{documentTemplateListController.model.rowCount} из #{documentTemplateListController.model.totalCount}  &#160;&#160;| #{msgs.amountPerPage}"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {CurrentPageReport} {RowsPerPageDropdown}"
				selection="#{documentTemplateListController.documentTemplate}"
				first="#{documentTemplateListController.first}">
				<p:ajax event="page"
					listener="#{documentTemplateListController.onPageChange}" />

				<p:column headerText="№">
					<h:outputText value="#{index+1}" />
				</p:column>

				<p:column headerText="#{msgs.documentType}">
					<h:outputText value="#{enums[entity.type]}" />
				</p:column>

				<p:column headerText="#{msgs.file}">
					<h:outputText value="#{entity.attachment.fileName}" />
				</p:column>

				<p:column headerText="#{msgs.dateModified}">
					<h:outputText value="#{entity.date}">
						<f:convertDateTime pattern="dd-MM-yyyy" />
					</h:outputText>
				</p:column>
				<p:column headerText="#{msgs.download}">
					<p:commandButton value="#{msgs.download}" ajax="false"
						onclick="PrimeFaces.monitorDownload(start, stop);"
						icon="ui-icon-arrowthick-1-s">
						<p:fileDownload
							value="#{downloadController.downloadFile(entity.attachment)}" />
					</p:commandButton>
				</p:column>

				<p:column headerText="#{msgs.operation}"
					rendered="#{roleController.isAllowed('ADMIN')}">
					<h:commandButton action="#{documentTemplateCreator.edit(entity)}"
						value="#{msgs.edit}" styleClass="btn-icon edit"
						title="#{msgs.edit}" />
					<h:commandButton
						action="#{documentTemplateCreator.doDelete(entity)}"
						value="#{msgs.delete}" styleClass="btn-icon delete"
						title="#{msgs.delete}"
						onclick="return confirm('#{msgs.areYouSureToDeleteDenounce}');" />

				</p:column>
			</p:dataTable>
		</h:form>
		<p:blockUI block="form:table" trigger="form:table">
			#{msgs.loading}<br />
			<p:graphicImage library="img" name="ajaxloadingbar.gif" />
		</p:blockUI>

		<div class="clear"></div>
	</ui:define>

</ui:composition>